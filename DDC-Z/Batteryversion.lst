C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE BATTERYVERSION
OBJECT MODULE PLACED IN .\Batteryversion.obj
COMPILER INVOKED BY: D:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE ..\Library\Batteryversion.c COMPACT ROM(COMPACT) OPT
                    -IMIZE(8,SPEED) BROWSE INCDIR(..\Library) DEBUG OBJECTEXTEND PRINT(.\Batteryversion.lst) TABS(3) OBJECT(.\Batteryversion.
                    -obj)

line level    source

   1          /*---------------------------------------------------
   2             Batteryversion.c (v1.00)
   3             old
   4             电池电量判断
   5          ---------------------------------------------------*/ 
   6          
   7          #include "main.h"
   8          #include "port.h"
   9          
  10          #include "Batteryversion.h"
  11          #include "voice.h"
  12          #include "Delay.h"
  13          #include "AD.h"
  14          
  15          extern tWord ADC_check_result;      
  16          extern tByte Check2_stage;
  17          extern tByte Battery_level;
  18          
  19          /*----------------------------------------------------
  20             Z2_broadcast_battery_old()
  21             voice alarm for battery status with power module
  22          -----------------------------------------------------*/
  23          void Z2_broadcast_battery_old(tWord Check2)
  24             {  
  25   1         if(Check2 < 0x21f)
  26   1            Battery_level = 48;
  27   1         else if(Check2 > 0x224)
  28   1            Battery_level = 60;
  29   1            
  30   1         switch(Battery_level)
  31   1            {
  32   2            case 48:
  33   2               {
  34   3               // battery is sufficient, battery > 50.5V, 3.14V/4.93V
  35   3               if((Check2 >= 0x1ff))
  36   3                  {
  37   4                  voice_EN = 1;
  38   4                  SC_Speech(18);    
  39   4                  Delay(60);
  40   4                  voice_EN = 0;
  41   4                  }
  42   3               // 20km, 49.5V < battery < 50.5V, 3.08V/4.93V
  43   3               else if((Check2 < 0x1ff)&&(Check2 >= 0x1f7))    
  44   3                  {
  45   4                  voice_EN = 1;
  46   4                  SC_Speech(8);  
  47   4                  Delay(100);
  48   4                  voice_EN = 0;
  49   4                  }
  50   3               // 15km, 48.8V < battery < 49.5V, 3.03V/4.93V 
  51   3               else if((Check2 < 0x1f7)&&(Check2 >= 0x1ef))    
  52   3                  {
  53   4                  voice_EN = 1;
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 2   

  54   4                  SC_Speech(7);     
  55   4                  Delay(100);
  56   4                  voice_EN = 0;
  57   4                  }
  58   3               // 10km, 48V < battery <48.8V, 2.99V/4.9V
  59   3               else if((Check2 < 0x1ef)&&(Check2 >= 0x1e6))    
  60   3                  {
  61   4                  voice_EN = 1;
  62   4                  SC_Speech(6);     
  63   4                  Delay(100);
  64   4                  voice_EN = 0;
  65   4                  }
  66   3               // 5km, 46.8V < battery < 48V, 2.91V/4.9V
  67   3               else if((Check2 < 0x1e6)&&(Check2 >= 0x1df))    
  68   3                  {
  69   4                  voice_EN =1;
  70   4                  SC_Speech(5);     
  71   4                  Delay(100);
  72   4                  voice_EN = 0;
  73   4                  }                     
  74   3               // battery is low, battery < 46.8V, 
  75   3               else if(Check2 < 0x1df)
  76   3                  {
  77   4                  motorBAT_low_speech();
  78   4                  }        
  79   3               }
  80   2            break;
  81   2            
  82   2            case 60:
  83   2               {
  84   3               // battery is sufficient, battery > 63.5V, 3.95V/4.93V
  85   3               if((Check2 >= 0x27e))
  86   3                  {
  87   4                  voice_EN = 1;
  88   4                  SC_Speech(18);    
  89   4                  Delay(60);
  90   4                  voice_EN = 0;
  91   4                  }
  92   3               // 35km, 62V < battery < 63.5V, 3.86V/4.93V
  93   3               else if((Check2 < 0x27e)&&(Check2 >= 0x26e))    
  94   3                  {
  95   4                  voice_EN = 1;
  96   4                  SC_Speech(9);  
  97   4                  Delay(100);
  98   4                  voice_EN = 0;
  99   4                  }
 100   3               // 20km, 60V < battery < 62V, 3.74V/4.93V
 101   3               else if((Check2 < 0x26e)&&(Check2 >= 0x25b))    
 102   3                  {
 103   4                  voice_EN = 1;
 104   4                  SC_Speech(8);  
 105   4                  Delay(100);
 106   4                  voice_EN = 0;
 107   4                  }
 108   3               // 15km, 59.3V < battery < 60V, 3.7V/4.93V 
 109   3               else if((Check2 < 0x25b)&&(Check2 >= 0x255))    
 110   3                  {
 111   4                  voice_EN = 1;
 112   4                  SC_Speech(7);     
 113   4                  Delay(100);
 114   4                  voice_EN = 0;
 115   4                  }
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 3   

 116   3               // 10km, 58.3V < battery <59.3V, 3.64V/4.93V
 117   3               else if((Check2 < 0x255)&&(Check2 >= 0x24c))    
 118   3                  {
 119   4                  voice_EN = 1;
 120   4                  SC_Speech(6);     
 121   4                  Delay(100);
 122   4                  voice_EN = 0;
 123   4                  }
 124   3               // 5km, 57.6V < battery < 58.3V, 3.6V/4.93V
 125   3               else if((Check2 < 0x24c)&&(Check2 >= 0x244))    
 126   3                  {
 127   4                  voice_EN =1;
 128   4                  SC_Speech(5);     
 129   4                  Delay(100);
 130   4                  voice_EN = 0;
 131   4                  }                     
 132   3               // battery is low, battery < 57.6V, 
 133   3               else if(Check2 < 0x244)
 134   3                  {
 135   4                  motorBAT_low_speech();
 136   4                  }
 137   3               }
 138   2            }  
 139   1         }
 140          
 141          /*----------------------------------------------------
 142             Z3_broadcast_battery_old()
 143             voice alarm for battery status with power module
 144          -----------------------------------------------------*/
 145          void Z3_broadcast_battery_old(tWord Check2)
 146             {  
 147   1         if(Check2 < 0x2a0)
 148   1            Battery_level = 48;
 149   1         else if(Check2 > 0x2a1)
 150   1            Battery_level = 60;
 151   1            
 152   1         switch(Battery_level)
 153   1            {
 154   2            case 48:
 155   2               {
 156   3               // battery is sufficient, battery > 50.5V, 3.14V/4.93V
 157   3               if((Check2 >= 0x261))
 158   3                  {
 159   4                  voice_EN = 1;
 160   4                  SC_Speech(18);    
 161   4                  Delay(60);
 162   4                  voice_EN = 0;
 163   4                  }
 164   3               // 20km, 49.5V < battery < 50.5V, 3.08V/4.93V
 165   3               else if((Check2 < 0x261)&&(Check2 >= 0x257))    
 166   3                  {
 167   4                  voice_EN = 1;
 168   4                  SC_Speech(8);  
 169   4                  Delay(100);
 170   4                  voice_EN = 0;
 171   4                  }
 172   3               // 15km, 48.8V < battery < 49.5V, 3.03V/4.93V 
 173   3               else if((Check2 < 0x257)&&(Check2 >= 0x24d))    
 174   3                  {
 175   4                  voice_EN = 1;
 176   4                  SC_Speech(7);     
 177   4                  Delay(100);
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 4   

 178   4                  voice_EN = 0;
 179   4                  }
 180   3               // 10km, 48V < battery <48.8V, 2.99V/4.9V
 181   3               else if((Check2 < 0x24d)&&(Check2 >= 0x243))    
 182   3                  {
 183   4                  voice_EN = 1;
 184   4                  SC_Speech(6);     
 185   4                  Delay(100);
 186   4                  voice_EN = 0;
 187   4                  }
 188   3               // 5km, 46.8V < battery < 48V, 2.91V/4.9V
 189   3               else if((Check2 < 0x243)&&(Check2 >= 0x236))    
 190   3                  {
 191   4                  voice_EN =1;
 192   4                  SC_Speech(5);     
 193   4                  Delay(100);
 194   4                  voice_EN = 0;
 195   4                  }                     
 196   3               // battery is low, battery < 46.8V, 
 197   3               else if(Check2 < 0x236)
 198   3                  {
 199   4                  motorBAT_low_speech();
 200   4                  }        
 201   3               }
 202   2            break;
 203   2            
 204   2            case 60:
 205   2               {
 206   3               // battery is sufficient, battery > 63.5V, 3.95V/4.93V
 207   3               if((Check2 >= 0x2f9))
 208   3                  {
 209   4                  voice_EN = 1;
 210   4                  SC_Speech(18);    
 211   4                  Delay(60);
 212   4                  voice_EN = 0;
 213   4                  }
 214   3               // 35km, 62V < battery < 63.5V, 3.86V/4.93V
 215   3               else if((Check2 < 0x2f9)&&(Check2 >= 0x2e5))    
 216   3                  {
 217   4                  voice_EN = 1;
 218   4                  SC_Speech(9);  
 219   4                  Delay(100);
 220   4                  voice_EN = 0;
 221   4                  }
 222   3               // 20km, 60V < battery < 62V, 3.74V/4.93V
 223   3               else if((Check2 < 0x2e5)&&(Check2 >= 0x2cf))    
 224   3                  {
 225   4                  voice_EN = 1;
 226   4                  SC_Speech(8);  
 227   4                  Delay(100);
 228   4                  voice_EN = 0;
 229   4                  }
 230   3               // 15km, 59.3V < battery < 60V, 3.7V/4.93V 
 231   3               else if((Check2 < 0x2cf)&&(Check2 >= 0x2c7))    
 232   3                  {
 233   4                  voice_EN = 1;
 234   4                  SC_Speech(7);     
 235   4                  Delay(100);
 236   4                  voice_EN = 0;
 237   4                  }
 238   3               // 10km, 58.3V < battery <59.3V, 3.64V/4.93V
 239   3               else if((Check2 < 0x2c7)&&(Check2 >= 0x2bd))    
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 5   

 240   3                  {
 241   4                  voice_EN = 1;
 242   4                  SC_Speech(6);     
 243   4                  Delay(100);
 244   4                  voice_EN = 0;
 245   4                  }
 246   3               // 5km, 57.6V < battery < 58.3V, 3.6V/4.93V
 247   3               else if((Check2 < 0x2bd)&&(Check2 >= 0x2b3))    
 248   3                  {
 249   4                  voice_EN =1;
 250   4                  SC_Speech(5);     
 251   4                  Delay(100);
 252   4                  voice_EN = 0;
 253   4                  }                     
 254   3               // battery is low, battery < 57.6V, 
 255   3               else if(Check2 < 0x2b3)
 256   3                  {
 257   4                  motorBAT_low_speech();
 258   4                  }
 259   3               }
 260   2            }
 261   1         }
 262             
 263          /*----------------------------------------------------
 264             Z2_broadcast_battery_1506()
 265             voice alarm for battery status with power module
 266          -----------------------------------------------------*/
 267          void Z2_broadcast_battery_1506(tWord Check2)
 268             {  
 269   1         if(Check2 < 0x21f)
 270   1            Battery_level = 48;
 271   1         else if(Check2 > 0x224)
 272   1            Battery_level = 60;
 273   1            
 274   1         switch(Battery_level)
 275   1            {
 276   2            case 48:
 277   2               {
 278   3               // battery is sufficient, battery > 50.5V, 3.14V/4.93V
 279   3               if((Check2 >= 0x1ff))
 280   3                  {
 281   4                  voice_EN = 1;
 282   4                  SC_Speech(20);    
 283   4                  Delay(60);
 284   4                  voice_EN = 0;
 285   4                  }
 286   3               // 20km, 49.5V < battery < 50.5V, 3.08V/4.93V
 287   3               else if((Check2 < 0x1ff)&&(Check2 >= 0x1f7))    
 288   3                  {
 289   4                  voice_EN = 1;
 290   4                  SC_Speech(8);  
 291   4                  Delay(100);
 292   4                  voice_EN = 0;
 293   4                  }
 294   3               // 15km, 48.8V < battery < 49.5V, 3.03V/4.93V 
 295   3               else if((Check2 < 0x1f7)&&(Check2 >= 0x1ef))    
 296   3                  {
 297   4                  voice_EN = 1;
 298   4                  SC_Speech(7);     
 299   4                  Delay(100);
 300   4                  voice_EN = 0;
 301   4                  }
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 6   

 302   3               // 10km, 48V < battery <48.8V, 2.99V/4.9V
 303   3               else if((Check2 < 0x1ef)&&(Check2 >= 0x1e6))    
 304   3                  {
 305   4                  voice_EN = 1;
 306   4                  SC_Speech(6);     
 307   4                  Delay(100);
 308   4                  voice_EN = 0;
 309   4                  }
 310   3               // 5km, 46.8V < battery < 48V, 2.91V/4.9V
 311   3               else if((Check2 < 0x1e6)&&(Check2 >= 0x1df))    
 312   3                  {
 313   4                  voice_EN =1;
 314   4                  SC_Speech(5);     
 315   4                  Delay(100);
 316   4                  voice_EN = 0;
 317   4                  }                     
 318   3               // battery is low, battery < 46.8V, 
 319   3               else if(Check2 < 0x1df)
 320   3                  {
 321   4                  motorBAT_low_speech();
 322   4                  }        
 323   3               }
 324   2            break;
 325   2            
 326   2            case 60:
 327   2               {
 328   3               // battery is sufficient, battery > 63.5V, 3.95V/4.93V
 329   3               if((Check2 >= 0x27e))
 330   3                  {
 331   4                  voice_EN = 1;
 332   4                  SC_Speech(20);    
 333   4                  Delay(60);
 334   4                  voice_EN = 0;
 335   4                  }
 336   3               // 35km, 62V < battery < 63.5V, 3.86V/4.93V
 337   3               else if((Check2 < 0x27e)&&(Check2 >= 0x26e))    
 338   3                  {
 339   4                  voice_EN = 1;
 340   4                  SC_Speech(9);  
 341   4                  Delay(100);
 342   4                  voice_EN = 0;
 343   4                  }
 344   3               // 20km, 60V < battery < 62V, 3.74V/4.93V
 345   3               else if((Check2 < 0x26e)&&(Check2 >= 0x25b))    
 346   3                  {
 347   4                  voice_EN = 1;
 348   4                  SC_Speech(8);  
 349   4                  Delay(100);
 350   4                  voice_EN = 0;
 351   4                  }
 352   3               // 15km, 59.3V < battery < 60V, 3.7V/4.93V 
 353   3               else if((Check2 < 0x25b)&&(Check2 >= 0x255))    
 354   3                  {
 355   4                  voice_EN = 1;
 356   4                  SC_Speech(7);     
 357   4                  Delay(100);
 358   4                  voice_EN = 0;
 359   4                  }
 360   3               // 10km, 58.3V < battery <59.3V, 3.64V/4.93V
 361   3               else if((Check2 < 0x255)&&(Check2 >= 0x24c))    
 362   3                  {
 363   4                  voice_EN = 1;
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 7   

 364   4                  SC_Speech(6);     
 365   4                  Delay(100);
 366   4                  voice_EN = 0;
 367   4                  }
 368   3               // 5km, 57.6V < battery < 58.3V, 3.6V/4.93V
 369   3               else if((Check2 < 0x24c)&&(Check2 >= 0x244))    
 370   3                  {
 371   4                  voice_EN =1;
 372   4                  SC_Speech(5);     
 373   4                  Delay(100);
 374   4                  voice_EN = 0;
 375   4                  }                     
 376   3               // battery is low, battery < 57.6V, 
 377   3               else if(Check2 < 0x244)
 378   3                  {
 379   4                  motorBAT_low_speech();
 380   4                  }
 381   3               }
 382   2            }
 383   1         }
 384          
 385          /*----------------------------------------------------
 386             Z3_broadcast_battery_1506()
 387             voice alarm for battery status with power module
 388          -----------------------------------------------------*/
 389          void Z3_broadcast_battery_1506(tWord Check2)
 390             {  
 391   1         if(Check2 < 0x2a0)
 392   1            Battery_level = 48;
 393   1         else if(Check2 > 0x2a1)
 394   1            Battery_level = 60;
 395   1            
 396   1         switch(Battery_level)
 397   1            {
 398   2            case 48:
 399   2               {
 400   3               // battery is sufficient, battery > 50.5V, 3.14V/4.93V
 401   3               if((Check2 >= 0x261))
 402   3                  {
 403   4                  voice_EN = 1;
 404   4                  SC_Speech(20);    
 405   4                  Delay(60);
 406   4                  voice_EN = 0;
 407   4                  }
 408   3               // 20km, 49.5V < battery < 50.5V, 3.08V/4.93V
 409   3               else if((Check2 < 0x261)&&(Check2 >= 0x257))    
 410   3                  {
 411   4                  voice_EN = 1;
 412   4                  SC_Speech(8);  
 413   4                  Delay(100);
 414   4                  voice_EN = 0;
 415   4                  }
 416   3               // 15km, 48.8V < battery < 49.5V, 3.03V/4.93V 
 417   3               else if((Check2 < 0x257)&&(Check2 >= 0x24d))    
 418   3                  {
 419   4                  voice_EN = 1;
 420   4                  SC_Speech(7);     
 421   4                  Delay(100);
 422   4                  voice_EN = 0;
 423   4                  }
 424   3               // 10km, 48V < battery <48.8V, 2.99V/4.9V
 425   3               else if((Check2 < 0x24d)&&(Check2 >= 0x243))    
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 8   

 426   3                  {
 427   4                  voice_EN = 1;
 428   4                  SC_Speech(6);     
 429   4                  Delay(100);
 430   4                  voice_EN = 0;
 431   4                  }
 432   3               // 5km, 46.8V < battery < 48V, 2.91V/4.9V
 433   3               else if((Check2 < 0x243)&&(Check2 >= 0x236))    
 434   3                  {
 435   4                  voice_EN =1;
 436   4                  SC_Speech(5);     
 437   4                  Delay(100);
 438   4                  voice_EN = 0;
 439   4                  }                     
 440   3               // battery is low, battery < 46.8V, 
 441   3               else if(Check2 < 0x236)
 442   3                  {
 443   4                  motorBAT_low_speech();
 444   4                  }        
 445   3               }
 446   2            break;
 447   2            
 448   2            case 60:
 449   2               {
 450   3               // battery is sufficient, battery > 63.5V, 3.95V/4.93V
 451   3               if((Check2 >= 0x2f9))
 452   3                  {
 453   4                  voice_EN = 1;
 454   4                  SC_Speech(20);    
 455   4                  Delay(60);
 456   4                  voice_EN = 0;
 457   4                  }
 458   3               // 35km, 62V < battery < 63.5V, 3.86V/4.93V
 459   3               else if((Check2 < 0x2f9)&&(Check2 >= 0x2e5))    
 460   3                  {
 461   4                  voice_EN = 1;
 462   4                  SC_Speech(9);  
 463   4                  Delay(100);
 464   4                  voice_EN = 0;
 465   4                  }
 466   3               // 20km, 60V < battery < 62V, 3.74V/4.93V
 467   3               else if((Check2 < 0x2e5)&&(Check2 >= 0x2cf))    
 468   3                  {
 469   4                  voice_EN = 1;
 470   4                  SC_Speech(8);  
 471   4                  Delay(100);
 472   4                  voice_EN = 0;
 473   4                  }
 474   3               // 15km, 59.3V < battery < 60V, 3.7V/4.93V 
 475   3               else if((Check2 < 0x2cf)&&(Check2 >= 0x2c7))    
 476   3                  {
 477   4                  voice_EN = 1;
 478   4                  SC_Speech(7);     
 479   4                  Delay(100);
 480   4                  voice_EN = 0;
 481   4                  }
 482   3               // 10km, 58.3V < battery <59.3V, 3.64V/4.93V
 483   3               else if((Check2 < 0x2c7)&&(Check2 >= 0x2bd))    
 484   3                  {
 485   4                  voice_EN = 1;
 486   4                  SC_Speech(6);     
 487   4                  Delay(100);
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 9   

 488   4                  voice_EN = 0;
 489   4                  }
 490   3               // 5km, 57.6V < battery < 58.3V, 3.6V/4.93V
 491   3               else if((Check2 < 0x2bd)&&(Check2 >= 0x2b3))    
 492   3                  {
 493   4                  voice_EN =1;
 494   4                  SC_Speech(5);     
 495   4                  Delay(100);
 496   4                  voice_EN = 0;
 497   4                  }                     
 498   3               // battery is low, battery < 57.6V, 
 499   3               else if(Check2 < 0x2b3)
 500   3                  {
 501   4                  motorBAT_low_speech();
 502   4                  }
 503   3               }
 504   2            }
 505   1         }
 506          
 507          /*----------------------------------------------------
 508             Z2_broadcast_battery_1512()
 509             voice alarm for battery status with power module
 510          -----------------------------------------------------*/
 511          void Z2_broadcast_battery_1512(tWord Check2)
 512             {  
 513   1         if(Check2 < 0x240)
 514   1            Battery_level = 48;
 515   1         else if(Check2 > 0x240)
 516   1            Battery_level = 60;
 517   1            
 518   1         switch(Battery_level)
 519   1            {
 520   2            case 48:
 521   2               {
 522   3               // battery is sufficient, battery > 50.5V, 3.14V/4.7V
 523   3               if((Check2 >= 0x213))
 524   3                  {
 525   4                  voice_EN = 1;
 526   4                  SC_Speech(20);    
 527   4                  Delay(60);
 528   4                  voice_EN = 0;
 529   4                  }
 530   3               // 20km, 49.5V < battery < 50.5V, 3.08V/4.93V
 531   3               else if((Check2 < 0x213)&&(Check2 >= 0x20a))    
 532   3                  {
 533   4                  voice_EN = 1;
 534   4                  SC_Speech(8);  
 535   4                  Delay(100);
 536   4                  voice_EN = 0;
 537   4                  }
 538   3               // 15km, 48.8V < battery < 49.5V, 3.03V/4.93V 
 539   3               else if((Check2 < 0x20a)&&(Check2 >= 0x202))    
 540   3                  {
 541   4                  voice_EN = 1;
 542   4                  SC_Speech(7);     
 543   4                  Delay(100);
 544   4                  voice_EN = 0;
 545   4                  }
 546   3               // 10km, 48V < battery <48.8V, 2.99V/4.9V
 547   3               else if((Check2 < 0x202)&&(Check2 >= 0x1f9))    
 548   3                  {
 549   4                  voice_EN = 1;
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 10  

 550   4                  SC_Speech(6);     
 551   4                  Delay(100);
 552   4                  voice_EN = 0;
 553   4                  }
 554   3               // 5km, 46.8V < battery < 48V, 2.91V/4.9V
 555   3               else if((Check2 < 0x1f9)&&(Check2 >= 0x1ee))    
 556   3                  {
 557   4                  voice_EN =1;
 558   4                  SC_Speech(5);     
 559   4                  Delay(100);
 560   4                  voice_EN = 0;
 561   4                  }                     
 562   3               // battery is low, battery < 46.8V, 
 563   3               else if(Check2 < 0x1ee)
 564   3                  {
 565   4                  motorBAT_low_speech();
 566   4                  }        
 567   3               }
 568   2            break;
 569   2            
 570   2            case 60:
 571   2               {
 572   3               // battery is sufficient, battery > 63.5V, 3.95V/4.7V
 573   3               if((Check2 >= 0x298))
 574   3                  {
 575   4                  voice_EN = 1;
 576   4                  SC_Speech(20);    
 577   4                  Delay(60);
 578   4                  voice_EN = 0;
 579   4                  }
 580   3               // 35km, 62V < battery < 63.5V, 3.86V/4.93V
 581   3               else if((Check2 < 0x298)&&(Check2 >= 0x287))    
 582   3                  {
 583   4                  voice_EN = 1;
 584   4                  SC_Speech(9);  
 585   4                  Delay(100);
 586   4                  voice_EN = 0;
 587   4                  }
 588   3               // 20km, 60V < battery < 62V, 3.74V/4.93V
 589   3               else if((Check2 < 0x287)&&(Check2 >= 0x273))    
 590   3                  {
 591   4                  voice_EN = 1;
 592   4                  SC_Speech(8);  
 593   4                  Delay(100);
 594   4                  voice_EN = 0;
 595   4                  }
 596   3               // 15km, 59.3V < battery < 60V, 3.7V/4.93V 
 597   3               else if((Check2 < 0x273)&&(Check2 >= 0x26c))    
 598   3                  {
 599   4                  voice_EN = 1;
 600   4                  SC_Speech(7);     
 601   4                  Delay(100);
 602   4                  voice_EN = 0;
 603   4                  }
 604   3               // 10km, 58.3V < battery <59.3V, 3.64V/4.93V
 605   3               else if((Check2 < 0x26c)&&(Check2 >= 0x264))    
 606   3                  {
 607   4                  voice_EN = 1;
 608   4                  SC_Speech(6);     
 609   4                  Delay(100);
 610   4                  voice_EN = 0;
 611   4                  }
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 11  

 612   3               // 5km, 57.6V < battery < 58.3V, 3.6V/4.93V
 613   3               else if((Check2 < 0x264)&&(Check2 >= 0x25b))    
 614   3                  {
 615   4                  voice_EN =1;
 616   4                  SC_Speech(5);     
 617   4                  Delay(100);
 618   4                  voice_EN = 0;
 619   4                  }                     
 620   3               // battery is low, battery < 57.6V, 
 621   3               else if(Check2 < 0x25b)
 622   3                  {
 623   4                  motorBAT_low_speech();
 624   4                  }
 625   3               }
 626   2            }
 627   1         }
 628          
 629          /*----------------------------------------------------
 630             Z3_broadcast_battery_1512()
 631             voice alarm for battery status with power module
 632          -----------------------------------------------------*/
 633          void Z3_broadcast_battery_1512(tWord Check2)
 634             {  
 635   1         if(Check2 < 0x240)
 636   1            Battery_level = 48;
 637   1         else if(Check2 > 0x240)
 638   1            Battery_level = 60;
 639   1            
 640   1         switch(Battery_level)
 641   1            {
 642   2            case 48:
 643   2               {
 644   3               // battery is sufficient, battery > 50.5V, 3.14V/4.7V
 645   3               if((Check2 >= 0x213))
 646   3                  {
 647   4                  voice_EN = 1;
 648   4                  SC_Speech(20);    
 649   4                  Delay(60);
 650   4                  voice_EN = 0;
 651   4                  }
 652   3               // 20km, 49.5V < battery < 50.5V, 3.08V/4.93V
 653   3               else if((Check2 < 0x213)&&(Check2 >= 0x20a))    
 654   3                  {
 655   4                  voice_EN = 1;
 656   4                  SC_Speech(8);  
 657   4                  Delay(100);
 658   4                  voice_EN = 0;
 659   4                  }
 660   3               // 15km, 48.8V < battery < 49.5V, 3.03V/4.93V 
 661   3               else if((Check2 < 0x20a)&&(Check2 >= 0x202))    
 662   3                  {
 663   4                  voice_EN = 1;
 664   4                  SC_Speech(7);     
 665   4                  Delay(100);
 666   4                  voice_EN = 0;
 667   4                  }
 668   3               // 10km, 48V < battery <48.8V, 2.99V/4.9V
 669   3               else if((Check2 < 0x202)&&(Check2 >= 0x1f9))    
 670   3                  {
 671   4                  voice_EN = 1;
 672   4                  SC_Speech(6);     
 673   4                  Delay(100);
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 12  

 674   4                  voice_EN = 0;
 675   4                  }
 676   3               // 5km, 46.8V < battery < 48V, 2.91V/4.9V
 677   3               else if((Check2 < 0x1f9)&&(Check2 >= 0x1ee))    
 678   3                  {
 679   4                  voice_EN =1;
 680   4                  SC_Speech(5);     
 681   4                  Delay(100);
 682   4                  voice_EN = 0;
 683   4                  }                     
 684   3               // battery is low, battery < 46.8V, 
 685   3               else if(Check2 < 0x1ee)
 686   3                  {
 687   4                  motorBAT_low_speech();
 688   4                  }        
 689   3               }
 690   2            break;
 691   2            
 692   2            case 60:
 693   2               {
 694   3               // battery is sufficient, battery > 63.5V, 3.95V/4.7V
 695   3               if((Check2 >= 0x298))
 696   3                  {
 697   4                  voice_EN = 1;
 698   4                  SC_Speech(20);    
 699   4                  Delay(60);
 700   4                  voice_EN = 0;
 701   4                  }
 702   3               // 35km, 62V < battery < 63.5V, 3.86V/4.93V
 703   3               else if((Check2 < 0x298)&&(Check2 >= 0x287))    
 704   3                  {
 705   4                  voice_EN = 1;
 706   4                  SC_Speech(9);  
 707   4                  Delay(100);
 708   4                  voice_EN = 0;
 709   4                  }
 710   3               // 20km, 60V < battery < 62V, 3.74V/4.93V
 711   3               else if((Check2 < 0x287)&&(Check2 >= 0x273))    
 712   3                  {
 713   4                  voice_EN = 1;
 714   4                  SC_Speech(8);  
 715   4                  Delay(100);
 716   4                  voice_EN = 0;
 717   4                  }
 718   3               // 15km, 59.3V < battery < 60V, 3.7V/4.93V 
 719   3               else if((Check2 < 0x273)&&(Check2 >= 0x26c))    
 720   3                  {
 721   4                  voice_EN = 1;
 722   4                  SC_Speech(7);     
 723   4                  Delay(100);
 724   4                  voice_EN = 0;
 725   4                  }
 726   3               // 10km, 58.3V < battery <59.3V, 3.64V/4.93V
 727   3               else if((Check2 < 0x26c)&&(Check2 >= 0x264))    
 728   3                  {
 729   4                  voice_EN = 1;
 730   4                  SC_Speech(6);     
 731   4                  Delay(100);
 732   4                  voice_EN = 0;
 733   4                  }
 734   3               // 5km, 57.6V < battery < 58.3V, 3.6V/4.93V
 735   3               else if((Check2 < 0x264)&&(Check2 >= 0x25b))    
C51 COMPILER V9.54   BATTERYVERSION                                                        06/06/2016 14:25:23 PAGE 13  

 736   3                  {
 737   4                  voice_EN =1;
 738   4                  SC_Speech(5);     
 739   4                  Delay(100);
 740   4                  voice_EN = 0;
 741   4                  }                     
 742   3               // battery is low, battery < 57.6V, 
 743   3               else if(Check2 < 0x25b)
 744   3                  {
 745   4                  motorBAT_low_speech();
 746   4                  }
 747   3               }
 748   2            }
 749   1         }
 750          
 751          /*---------------------------------------------------
 752             end of file
 753          ----------------------------------------------------*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2436    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----      12
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
